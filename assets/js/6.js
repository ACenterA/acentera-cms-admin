webpackJsonp([6,36,37],{684:function(t,e,s){var a=s(1)(s(733),s(758),null,null);t.exports=a.exports},686:function(t,e,s){var a=s(1)(s(735),s(761),null,null);t.exports=a.exports},698:function(t,e,s){s(833);var a=s(1)(s(775),s(861),"data-v-653f98fa",null);t.exports=a.exports},733:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(10);e.default={components:{Modal:a.a},props:{visible:Boolean,title:String,info:String},methods:{close:function(){this.$emit("close")},confirmed:function(){this.$emit("confirmed")}}}},735:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(10);e.default={components:{Modal:a.a},props:{visible:Boolean,title:String,info:String},methods:{close:function(){this.$emit("close")}}}},758:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal",{attrs:{visible:t.visible},on:{close:t.close}},[s("div",{staticClass:"box"},[s("article",{staticClass:"media"},[s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.title))]),t._v(" "),s("br"),t._v(" "),s("a",{staticClass:"button is-danger",on:{click:t.confirmed}},[s("span",[t._v("Delete")]),t._v(" "),s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-times"})])])])])])])])])},staticRenderFns:[]}},761:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal",{attrs:{visible:t.visible},on:{close:t.close}},[s("div",{staticClass:"box"},[s("article",{staticClass:"media"},[s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.title))]),t._v(" "),s("br"),t._v(t._s(t.info)+"\n          ")])])])])])])},staticRenderFns:[]}},775:function(t,e,s){"use strict";function a(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var n=s(686),i=s.n(n),o=s(684),l=s.n(o),r=["token","userpass","approle"],c=[["accessor","display_name","num_uses","orphan","policies","ttl"],["Name","TTL","Max_TTL","Policies"],["Roleid","Policies","Token_TTL","Token_max_TTL","Secret_id_TTL","Secret_id_num_uses"]];e.default={components:{Modal:i.a,ConfirmModal:l.a},data:function(){return{csrf:"",tabName:"token",tableData:[],tableColumns:["accessor","display_name","num_uses","orphan","policies","ttl"],showModal:!1,showDeleteModal:!1,selectedIndex:-1,currentPage:1,lastPage:1,tokenCount:0,loading:!1,search:{show:!1,str:"",found:0,searched:0,regex:!1,regexp:null}}},mounted:function(){var t=this;this.switchTab(0),this.$http.get("/api/users/csrf").then(function(e){t.csrf=e.headers["x-csrf-token"]}).catch(function(e){t.$onError(e)}),this.$http.get("/api/tokencount").then(function(e){t.tokenCount=e.data.result,t.lastPage=Math.ceil(e.data.result/300)}).catch(function(e){t.$onError(e)})},computed:{selectedItemTitle:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex][this.tableColumns[0]]):""},selectedItemInfo:function(){return-1!==this.selectedIndex?"This modal panel is under construction":""},confirmDeletionTitle:function(){return"Are you sure you want to delete this?"},nearbyPages:function(){return this.lastPage<6?[].concat(a(Array(this.lastPage).keys())).slice(2):1===this.currentPage||2===this.currentPage?[2,3]:this.currentPage+3>this.lastPage?[this.lastPage-3,this.lastPage-2,this.lastPage-1]:[this.currentPage-1,this.currentPage,this.currentPage+1]},searchRegex:function(){return this.search.regex}},filters:{capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{switchTab:function(t){var e=this;this.tableData=[],this.tabName=r[t],this.tableColumns=c[t],this.search={show:!1,str:"",found:0,searched:0,regex:!1,regexp:null},this.$http.get("/api/users?type="+this.tabName).then(function(t){e.tableData=t.data.result,e.csrf=t.headers["x-csrf-token"]}).catch(function(t){e.$onError(t)})},openModalBasic:function(t){this.selectedIndex=t,this.showModal=!0},closeModalBasic:function(){this.selectedIndex=-1,this.showModal=!1},openDeleteModal:function(t){this.selectedIndex=t,this.showDeleteModal=!0},closeDeleteModal:function(){this.selectedIndex=-1,this.showDeleteModal=!1},deleteItem:function(t){var e=this;this.$http.post("/api/users/revoke",{Type:this.tabName.toLowerCase(),ID:this.tableData[t][this.tableColumns[0]]},{headers:{"X-CSRF-Token":this.csrf}}).then(function(s){e.closeDeleteModal(),e.tableData.splice(t,1),e.$notify({title:"Success",message:"Deletion successful",type:"success"})}).catch(function(t){e.closeDeleteModal(),e.$onError(t)})},loadPage:function(t){var e=this;t<1||t>this.lastPage||this.search.searched||(this.currentPage=t,this.loading=!0,this.$http.get("/api/users?type=token&offset="+(300*(this.currentPage-1)).toString()).then(function(t){e.tableData=t.data.result,e.csrf=t.headers["x-csrf-token"],e.loading=!1}).catch(function(t){e.$onError(t),e.loading=!1}))},itemContainsSearchString:function(t){if(t)for(var e=0;e<this.tableColumns.length;e++)if(t[this.tableColumns[e]].toString().includes(this.search.str))return!0;return!1},itemContainsRegexExpr:function(t){if(t)for(var e=0;e<this.tableColumns.length;e++)if(this.search.regexp.test(t[this.tableColumns[e].toString()]))return!0;return!1},searchByString:function(){var t=this;if(""!==this.search.str){this.tableData=[],this.search.found=0,this.search.searched=0,this.loading=this.lastPage,this.search.regexp=new RegExp(this.search.str);for(var e=0;e<this.lastPage;e++)this.$http.get("/api/users?type=token&offset="+(300*e).toString()).then(function(e){var s=!1;s=t.search.regex?e.data.result.filter(t.itemContainsRegexExpr):e.data.result.filter(t.itemContainsSearchString),t.search.found+=s.length,t.search.searched+=e.data.result.length,t.tableData=t.tableData.concat(s),t.loading=t.loading-1||!1}).catch(function(e){t.$onError(e),t.loading=t.loading-1||!1})}},resetSearch:function(){this.search.str="",this.search.found=0,this.search.searched=0,this.loadPage(this.currentPage)}}}},808:function(t,e,s){e=t.exports=s(676)(),e.push([t.i,".button[data-v-653f98fa]{margin:5px 0 0}.control .button[data-v-653f98fa]{margin:inherit}.fa-trash-o[data-v-653f98fa]{color:red}.fa-info[data-v-653f98fa]{color:#87cefa}","",{version:3,sources:["/data/serverless-cms-admin/client/views/admin/Users.vue"],names:[],mappings:"AACA,yBACE,cAAgB,CACjB,AACD,kCACE,cAAgB,CACjB,AACD,6BACE,SAAW,CACZ,AACD,0BACE,aAAoB,CACrB",file:"Users.vue",sourcesContent:["\n.button[data-v-653f98fa] {\n  margin: 5px 0 0;\n}\n.control .button[data-v-653f98fa] {\n  margin: inherit;\n}\n.fa-trash-o[data-v-653f98fa] {\n  color: red;\n}\n.fa-info[data-v-653f98fa] {\n  color: lightskyblue;\n}\n"],sourceRoot:""}])},833:function(t,e,s){var a=s(808);"string"==typeof a&&(a=[[t.i,a,""]]);s(677)(a,{});a.locals&&(t.exports=a.locals)},861:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-parent is-vertical"},[s("article",{staticClass:"tile is-child box"},[s("div",{staticClass:"tabs is-medium is-boxed is-fullwidth"},[s("ul",[s("li",{class:"token"===t.tabName?"is-active":"",on:{click:function(e){t.switchTab(0)}}},[s("a",[t._v("Tokens")])]),t._v(" "),s("li",{class:"userpass"===t.tabName?"is-active":"",on:{click:function(e){t.switchTab(1)}}},[s("a",[t._v("Userpass")])]),t._v(" "),s("li",{class:"approle"===t.tabName?"is-active":"",on:{click:function(e){t.switchTab(2)}}},[s("a",[t._v("Approle")])]),t._v(" "),t._m(0)])]),t._v(" "),"token"===t.tabName?s("div",{staticClass:"tile is-parent table-responsive is-vertical"},[s("nav",{staticClass:"pagination is-right"},[s("a",{staticClass:"pagination-previous",attrs:{disabled:t.loading},on:{click:function(e){t.search.show=!t.search.show}}},[t._v("Search")]),t._v(" "),s("a",{staticClass:"pagination-previous",attrs:{disabled:t.loading||t.currentPage<2||!!t.search.searched},on:{click:function(e){t.loadPage(t.currentPage-1)}}},[t._v("Previous")]),t._v(" "),s("a",{staticClass:"pagination-next",attrs:{disabled:t.loading||t.currentPage>t.lastPage-1||!!t.search.searched},on:{click:function(e){t.loadPage(t.currentPage+1)}}},[t._v("Next page")]),t._v(" "),s("ul",{staticClass:"pagination-list"},[s("li",[s("a",{staticClass:"pagination-link",class:1===t.currentPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(e){t.loadPage(1)}}},[t._v("1")])]),t._v(" "),t.currentPage>3&&t.lastPage>5?s("li",[s("span",{staticClass:"pagination-ellipsis"},[t._v("…")])]):t._e(),t._v(" "),t._l(t.nearbyPages,function(e){return s("li",[s("a",{staticClass:"pagination-link",class:e===t.currentPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(s){t.loadPage(e)}}},[t._v(t._s(e))])])}),t._v(" "),t.lastPage-t.currentPage>2&&t.lastPage>5&&1!==t.lastPage?s("li",[s("span",{staticClass:"pagination-ellipsis"},[t._v("…")])]):t._e(),t._v(" "),1!==t.lastPage?s("li",[s("a",{staticClass:"pagination-link",class:t.currentPage===t.lastPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(e){t.loadPage(t.lastPage)}}},[t._v(t._s(t.lastPage))])]):t._e()],2)]),t._v(" "),s("label",{staticClass:"label"}),t._v(" "),t.search.show?s("article",{staticClass:"tile is-child box"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",class:t.loading?"is-loading":"",attrs:{disabled:0===t.search.searched},on:{click:function(e){t.resetSearch()}}},[t._v("\n                      Reset\n                    ")])])])]),t._v(" "),s("div",{staticClass:"level-item"},[0!==t.search.searched?s("p",{staticClass:"subtitle is-5"},[t._v("\n                  Found "),s("strong",[t._v(t._s(t.search.found))]),t._v(" matches out of "),s("strong",[t._v(t._s(t.search.searched))]),t._v(" tokens\n                ")]):s("p",{staticClass:"subtitle is-5"},[t._v("\n                  Displaying "),s("strong",[t._v(t._s(Math.min(t.tokenCount,300)))]),t._v(" out of "),s("strong",[t._v(t._s(t.tokenCount))]),t._v(" tokens\n                ")])]),t._v(" "),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[s("div",{staticClass:"field has-addons"},[s("p",{staticClass:"control has-icons-right"},[s("span",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.search.regex,expression:"search.regex"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.search.regex=e.target.multiple?s:s[0]}}},[s("option",{domProps:{value:!1}},[t._v("Substring")]),t._v(" "),s("option",{domProps:{value:!0}},[t._v("Regex")])])])]),t._v(" "),s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search.str,expression:"search.str"}],staticClass:"input",attrs:{type:"text",placeholder:"Search all tokens"},domProps:{value:t.search.str},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.searchByString()},input:function(e){e.target.composing||(t.search.str=e.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-info",class:t.loading?"is-loading":"",attrs:{disabled:""===t.search.str},on:{click:function(e){t.searchByString()}}},[t._v("\n                        Search\n                      ")])])])])])])]):t._e(),t._v(" "),s("label",{staticClass:"label"}),t._v(" "),s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(t._f("capitalize")(e))+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return e?s("td",[t._v("\n                  "+t._s(e[a])+"\n                ")]):s("td",[t._v("\n                  ERROR: An invalid token-accessor has been found\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})])])])],2)}))])]):t._e(),t._v(" "),"userpass"===t.tabName?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(e)+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return s("td",[t._v("\n                  "+t._s(e[a])+"\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})])])])],2)}))])]):t._e(),t._v(" "),"approle"===t.tabName?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(e)+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return s("td",[t._v("\n                  "+t._s(e[a])+"\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})])])])],2)}))])]):t._e()])])]),t._v(" "),s("modal",{attrs:{visible:t.showModal,title:t.selectedItemTitle,info:t.selectedItemInfo},on:{close:t.closeModalBasic}}),t._v(" "),s("confirmModal",{attrs:{visible:t.showDeleteModal,title:t.confirmDeletionTitle,info:t.selectedItemInfo},on:{close:t.closeDeleteModal,confirmed:function(e){t.deleteItem(t.selectedIndex)}}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{attrs:{disabled:""}},[s("a",[t._v("Certificates")])])}]}}});