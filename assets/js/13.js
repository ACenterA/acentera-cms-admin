webpackJsonp([13],{695:function(e,t,s){s(825);var r=s(1)(s(772),s(852),"data-v-2e99447c",null);e.exports=r.exports},716:function(e,t,s){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,s,n){t=t||"&",s=s||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var c=1e3;n&&"number"==typeof n.maxKeys&&(c=n.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var p,v,d,h,g=e[u].replace(o,"%20"),C=g.indexOf(s);C>=0?(p=g.substr(0,C),v=g.substr(C+1)):(p=g,v=""),d=decodeURIComponent(p),h=decodeURIComponent(v),r(i,d)?a(i[d])?i[d].push(h):i[d]=[i[d],h]:i[d]=h}return i};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},717:function(e,t,s){"use strict";function r(e,t){if(e.map)return e.map(t);for(var s=[],r=0;r<e.length;r++)s.push(t(e[r],r));return s}var a=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,s,o){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?r(i(e),function(i){var o=encodeURIComponent(a(i))+s;return n(e[i])?r(e[i],function(e){return o+encodeURIComponent(a(e))}).join(t):o+encodeURIComponent(a(e[i]))}).join(t):o?encodeURIComponent(a(o))+s+encodeURIComponent(a(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=Object.keys||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.push(s);return t}},718:function(e,t,s){"use strict";t.decode=t.parse=s(716),t.encode=t.stringify=s(717)},772:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(718);t.default={data:function(){return{csrf:"",searchString:"",searchType:"changeid",request:null,bConfirm:!1,bReject:!1,unsealToken:"",progress:0,required:0}},mounted:function(){},computed:{searchURL:function(){var e="/api/policy/request?type="+this.searchType;return"changeid"===this.searchType?e+="&id="+this.searchString:"commit"===this.searchType&&(e+="&sha="+this.searchString),e},updateURL:function(){var e="/api/policy/request/update?type="+this.searchType;return"changeid"===this.searchType?e+="&id="+this.searchString:"commit"===this.searchType&&(e+="&sha="+this.searchString),e}},methods:{search:function(){var e=this;null===this.request&&this.$http.get(this.searchURL).then(function(t){e.csrf=t.headers["x-csrf-token"],e.request=t.data.result,e.progress=t.data.progress,e.required=t.data.required}).catch(function(t){e.$onError(t)})},approve:function(){var e=this;this.$http.post(this.updateURL,r.stringify({unseal:this.unsealToken}),{headers:{"X-CSRF-Token":this.csrf}}).then(function(t){e.unsealToken="",t.data.progress?(e.progress=t.data.progress,e.$notify({title:"Progress",message:t.data.progress.toString()+" unseal tokens received so far",type:"success"}),1===t.data.progress&&e.$notify({title:"Timer started",message:"Other operators have a 1 hour window to enter their unseal tokens",duration:2e4,type:"warning"})):(e.progress=e.required,"changeid"===e.searchType&&(e.request.Current=t.data.result||e.request.Current),e.$notify({title:"Change success",message:"Root token generated and revoked",type:"success"}))}).catch(function(t){e.unsealToken="",e.progress=0,e.$onError(t)})},reject:function(){var e=this;this.$http.delete("/api/policy/request/"+this.searchString,{headers:{"X-CSRF-Token":this.csrf}}).then(function(t){e.$notify({title:"Deleted",message:"Request data purged",type:"warning"}),e.request=null}).catch(function(t){e.$onError(t)})}}}},800:function(e,t,s){t=e.exports=s(676)(),t.push([e.i,".button[data-v-2e99447c]{margin:5px 0 0}.control .button[data-v-2e99447c]{margin:inherit}.fa-trash-o[data-v-2e99447c]{color:red}.fa-info[data-v-2e99447c]{color:#87cefa}","",{version:3,sources:["/data/serverless-cms-admin/client/views/admin/Requests.vue"],names:[],mappings:"AACA,yBACE,cAAgB,CACjB,AACD,kCACE,cAAgB,CACjB,AACD,6BACE,SAAW,CACZ,AACD,0BACE,aAAoB,CACrB",file:"Requests.vue",sourcesContent:["\n.button[data-v-2e99447c] {\n  margin: 5px 0 0;\n}\n.control .button[data-v-2e99447c] {\n  margin: inherit;\n}\n.fa-trash-o[data-v-2e99447c] {\n  color: red;\n}\n.fa-info[data-v-2e99447c] {\n  color: lightskyblue;\n}\n"],sourceRoot:""}])},825:function(e,t,s){var r=s(800);"string"==typeof r&&(r=[[e.i,r,""]]);s(677)(r,{});r.locals&&(e.exports=r.locals)},852:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-parent is-vertical"},[s("article",{staticClass:"tile is-child box"},[s("div",{staticClass:"field"},[s("div",{staticClass:"field has-addons"},[null===e.request?s("p",{staticClass:"control has-icons-right"},[s("span",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.searchType,expression:"searchType"}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.searchType=t.target.multiple?s:s[0]}}},[s("option",{domProps:{value:"changeid"}},[e._v("Change ID")]),e._v(" "),s("option",{domProps:{value:"commit"}},[e._v("Commit Hash")])])])]):s("p",{staticClass:"control"},[s("a",{staticClass:"button is-danger",on:{click:function(t){e.request=null}}},[e._v("\n                Reset\n              ")])]),e._v(" "),s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.searchString,expression:"searchString"}],staticClass:"input",attrs:{type:"text",placeholder:"Enter a change ID",disabled:null!==e.request},domProps:{value:e.searchString},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.search()},input:function(t){t.target.composing||(e.searchString=t.target.value)}}})]),e._v(" "),s("p",{staticClass:"control"},[s("a",{staticClass:"button is-info",attrs:{disabled:null!==e.request},on:{click:function(t){e.search()}}},[e._v("\n                Search\n              ")])])])]),e._v(" "),null===e.request||e.request.length?e._e():s("article",[s("br"),e._v(" "),s("article",{staticClass:"message is-primary"},[s("div",{staticClass:"message-body"},[s("strong",[e._v("Requester display name: ")]),e._v(e._s(e.request.Requester)),s("br"),e._v(" "),s("strong",[e._v("Requester accessor hash: ")]),e._v(e._s(e.request.RequesterHash)),s("br"),e._v(" "),s("strong",[e._v("Policy: ")]),e._v(e._s(e.request.Policy)),s("br"),e._v(" "),s("strong",[e._v("Unseal progress: ")]),e._v("\n              "+e._s(e.progress)+" out of "+e._s(e.required)+" "),s("strong",[e._v(e._s(e.progress===e.required?" Done!":""))])])]),e._v(" "),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:function(t){e.bConfirm=!0}}},[e._v("Approve")])]),e._v(" "),s("p",{staticClass:"control"},[e.bReject?s("button",{staticClass:"button is-danger",on:{click:function(t){e.reject()}}},[e._v("Confirm Reject")]):s("button",{staticClass:"button is-warning",on:{click:function(t){e.bReject=!0}}},[e._v("Reject")])]),e._v(" "),e.bConfirm?s("div",{staticClass:"field has-addons"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.unsealToken,expression:"unsealToken"}],staticClass:"input",attrs:{type:"text",placeholder:"Enter an unseal token"},domProps:{value:e.unsealToken},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.approve()},input:function(t){t.target.composing||(e.unsealToken=t.target.value)}}})]),e._v(" "),s("p",{staticClass:"control"},[s("a",{staticClass:"button is-info",on:{click:function(t){e.approve()}}},[e._v("\n                  Confirm\n                ")])])]):e._e()]),e._v(" "),s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("article",{staticClass:"message is-primary"},[s("div",{staticClass:"message-header"},[e._v("\n                  Current policy rules\n                ")]),e._v(" "),s("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.request.Current,expression:"request.Current"}]},[s("code",{staticClass:"javascript"})])])]),e._v(" "),s("div",{staticClass:"column"},[s("article",{staticClass:"message is-info"},[s("div",{staticClass:"message-header"},[e._v("\n                Proposed policy rules\n                ")]),e._v(" "),s("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.request.New,expression:"request.New"}]},[s("code",{staticClass:"javascript"})])])])])]),e._v(" "),null!==e.request&&e.request.length>1?s("article",[s("br"),e._v(" "),s("article",{staticClass:"message is-primary"},[s("div",{staticClass:"message-body"},[s("strong",[e._v("Github commit hash: ")]),e._v(e._s(e.searchString)),s("br"),e._v(" "),s("strong",[e._v("Number of policies affected: ")]),e._v(e._s(e.request.length)),s("br"),e._v(" "),s("strong",[e._v("Unseal progress: ")]),e._v("\n              "+e._s(e.progress)+" out of "+e._s(e.required)+" "),s("strong",[e._v(e._s(e.progress===e.required?" Done!":""))])])]),e._v(" "),s("div",{staticClass:"field is-grouped"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-success",on:{click:function(t){e.bConfirm=!0}}},[e._v("Approve")])]),e._v(" "),e.bConfirm?s("div",{staticClass:"field has-addons"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.unsealToken,expression:"unsealToken"}],staticClass:"input",attrs:{type:"text",placeholder:"Enter an unseal token"},domProps:{value:e.unsealToken},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.approve()},input:function(t){t.target.composing||(e.unsealToken=t.target.value)}}})]),e._v(" "),s("p",{staticClass:"control"},[s("a",{staticClass:"button is-info",on:{click:function(t){e.approve()}}},[e._v("\n                  Confirm\n                ")])])]):e._e()]),e._v(" "),e._l(e.request,function(t,r){return s("div",{staticClass:"box"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[s("div",{staticClass:"content is-marginless is-paddingless"},[s("h3",{staticClass:"is-marginless is-paddingless"},[e._v(e._s(t.Policy))])])]),e._v(" "),s("div",{staticClass:"level-item"},[t.New&&t.Current?s("span",{staticClass:"tag is-info"},[e._v("Will be changed!")]):e._e(),e._v(" "),!t.New&&t.Current?s("span",{staticClass:"tag is-danger"},[e._v("Will be deleted!")]):e._e(),e._v(" "),t.New&&!t.Current?s("span",{staticClass:"tag is-success"},[e._v("Will be created!")]):e._e()])])]),e._v(" "),s("div",{staticClass:"columns"},[t.Current?s("div",{staticClass:"column"},[s("article",{staticClass:"message is-primary",class:t.New?"":"is-danger"},[s("div",{staticClass:"message-header"},[e._v("\n                    Current policy rules\n                  ")]),e._v(" "),s("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:t.Current,expression:"policy.Current"}]},[s("code",{staticClass:"javascript"})])])]):e._e(),e._v(" "),t.New?s("div",{staticClass:"column"},[s("article",{staticClass:"message is-info",class:t.Current?"":"is-success"},[s("div",{staticClass:"message-header"},[e._v("\n                  Proposed policy rules\n                  ")]),e._v(" "),s("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:t.New,expression:"policy.New"}]},[s("code",{staticClass:"javascript"})])])]):e._e()])])})],2):e._e()])])])])},staticRenderFns:[]}}});