webpackJsonp([1,15,33],{688:function(t,e,s){var a=s(1)(s(737),s(755),null,null);t.exports=a.exports},689:function(t,e,s){s(751);var a=s(1)(s(738),s(762),"data-v-72ccc35c",null);t.exports=a.exports},715:function(t,e,s){s(819);var a=s(1)(s(792),s(845),"data-v-05d95b08",null);t.exports=a.exports},737:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(10);e.default={components:{Modal:a.a},props:{visible:Boolean,title:String,info:String},methods:{close:function(){this.$emit("close")},confirmed:function(){this.$emit("confirmed")}}}},738:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s(10);e.default={components:{Modal:a.a},props:{visible:Boolean,title:String,commit:String,updated_on:String,desc:String,branch:String},methods:{close:function(){this.$emit("close")},select:function(){this.$emit("select",{branch:this.branch,commit:this.commit})},cancel:function(){this.close()}}}},743:function(t,e,s){e=t.exports=s(676)(),e.push([t.i,".content[data-v-72ccc35c]{min-height:350px}.box[data-v-72ccc35c]{min-height:400px}.btnNoPad[data-v-72ccc35c]{width:29%}.btn[data-v-72ccc35c]{width:29%;margin:30px}.rightfloat[data-v-72ccc35c]{float:right}","",{version:3,sources:["/data/serverless-cms-admin/client/views/versions/modals/InfoModal.vue"],names:[],mappings:"AACA,0BACG,gBAAkB,CACpB,AACD,sBACE,gBAAkB,CACnB,AACD,2BACE,SAAW,CACZ,AACD,sBACE,UAAW,AACX,WAAY,CACb,AACD,6BACE,WAAa,CACd",file:"InfoModal.vue",sourcesContent:["\n.content[data-v-72ccc35c] {\n   min-height: 350px;\n}\n.box[data-v-72ccc35c] {\n  min-height: 400px;\n}\n.btnNoPad[data-v-72ccc35c] {\n  width: 29%;\n}\n.btn[data-v-72ccc35c] {\n  width: 29%;\n  margin:30px;\n}\n.rightfloat[data-v-72ccc35c] {\n  float: right;\n}\n\n"],sourceRoot:""}])},751:function(t,e,s){var a=s(743);"string"==typeof a&&(a=[[t.i,a,""]]);s(677)(a,{});a.locals&&(t.exports=a.locals)},755:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal",{attrs:{visible:t.visible},on:{close:t.close}},[s("div",{staticClass:"box"},[s("article",{staticClass:"media"},[s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.title))]),t._v(" "),s("br"),t._v(" "),s("a",{staticClass:"button is-danger",on:{click:t.confirmed}},[s("span",[t._v("Delete")]),t._v(" "),s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-times"})])])])])])])])])},staticRenderFns:[]}},762:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("modal",{attrs:{visible:t.visible},on:{close:t.close}},[s("div",{staticClass:"box"},[s("button",{staticClass:"btnNoPad rightfloat",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),s("article",{staticClass:"media"},[s("div",{staticClass:"media-content"},[s("div",{staticClass:"content"},[s("p",[s("strong",[t._v(t._s(t.title))]),t._v(" "),s("br"),t._v("Last Update: "+t._s(t.updated_on)+"\n            "),s("br"),t._v(" "),s("br"),t._v(" "),s("br"),t._v(t._s(t.desc)+"\n          ")])])])]),t._v(" "),s("button",{staticClass:"btnNoPad rightfloat",on:{click:t.select}},[t._v("Select this Version")])])])},staticRenderFns:[]}},792:function(t,e,s){"use strict";function a(t){if(Array.isArray(t)){for(var e=0,s=Array(t.length);e<t.length;e++)s[e]=t[e];return s}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=s(689),n=s.n(i),o=s(688),r=s.n(o),c=s(2),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},d=["token","userpass","approle"],u=[["desc","updated_on","branch","author"],["title","state","updated_on","branch","commit"],["Roleid","Policies","Token_TTL","Token_max_TTL","Secret_id_TTL","Secret_id_num_uses"]];e.default={components:{Modal:n.a,ConfirmModal:r.a},data:function(){return{csrf:"",tabName:"token",tableData:[],tableColumns:["accessor","display_name","num_uses","orphan","policies","ttl"],showModal:!1,showDeleteModal:!1,repoState:this.$store.state.app.repoState,websiteId:this.$store.state.app.websiteId,selectedIndex:-1,currentPage:1,lastPage:1,tokenCount:0,loading:!1,search:{show:!1,str:"",found:0,searched:0,regex:!1,regexp:null}}},mounted:function(){this.switchTab(0)},computed:l({},s.i(c.mapGetters)({loaded:"loaded",github:"github",websiteIsGit:"websiteIsGit",selectedWebsite:"selectedWebsite"}),{invalidRepo:function(){return!this.repoState||"hidden"===this.repoState.url},notLoggedIn:function(){var t=this.github;return!t||(!t.logininfo||!t.logininfo.token&&!t.logininfo.pass)},selectedItemTitle:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex][this.tableColumns[0]]):""},selectedItemDesc:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex].description):""},selectedItemUpdatedOn:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex].updated_on):""},selectedItemCommit:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex].commit):""},selectedItemBranch:function(){return-1!==this.selectedIndex?String(this.tableData[this.selectedIndex].branch):""},selectedItemInfo:function(){return-1!==this.selectedIndex?"This modal panel is under construction":""},confirmDeletionTitle:function(){return"Are you sure you want to delete this?"},nearbyPages:function(){return this.lastPage<6?[].concat(a(Array(this.lastPage).keys())).slice(2):1===this.currentPage||2===this.currentPage?[2,3]:this.currentPage+3>this.lastPage?[this.lastPage-3,this.lastPage-2,this.lastPage-1]:[this.currentPage-1,this.currentPage,this.currentPage+1]},searchRegex:function(){return this.search.regex}}),filters:{capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},methods:{switchTab:function(t,e){var s=this;if(!this.$store.state.app.isLoaded)return setTimeout(function(){s.switchTab(t,e)},300);if(null==e&&(e=0),this.tableData=[],this.tabName=d[t],this.tableColumns=u[t],this.search={show:!1,str:"",found:0,searched:0,regex:!1,regexp:null},null==this.$store.state.app.repoState.url)return void(e<=10&&setTimeout(function(){s.switchTab(t,e+1)},1e3));var a=this.github,i=(""+this.$store.state.app.repoState.url).substring((""+this.$store.state.app.repoState.url).lastIndexOf("/")+1);i=i.substring(0,i.lastIndexOf(".git"));var n=!0;if(a){var o="repos/"+a.logininfo.username+"/"+i;1===t&&(o="/pulls");var r=this.$github;"BitBucket"===a.logininfo.type&&(r=this.$bitbucket,o="2.0/repositories/"+a.logininfo.username+"/"+i,1===t?o+="/pullrequests":o="/1.0/repositories/"+a.logininfo.username+"/"+i+"/branches",n=!1),window.vueAuth.getToken()?r.setToken(window.vueAuth.getToken()):r.setUserPass(a.logininfo.username,a.logininfo.pass),r.get(o,{},function(e){if(n);else{var a=e.values||e,i=[];if(0!==t||n)for(var o in a)1===t?(a[o].branch=a[o].source.branch.name,a[o].commit=a[o].source.commit.hash,i.push(a[o])):null===a[o].branch||i.push(a[o]);else for(var r in a)if(a.hasOwnProperty(r)){var c=a[r];"master"===c.branch?i.push(c):null===c.branch||"null"===c.branch||(""+c.message).indexOf("Merged in")>=0||i.push(c)}s.tableData=i}},this.gitError)}},openModalBasic:function(t){this.selectedIndex=t,this.showModal=!0},switchTo:function(t){var e=this;this.$httpApi.post(window.apiUrl+"/git?action=switch_branch",t,{headers:{Authorization:window.vm.$store.getters.getBasicAuth,Token:window.vueAuth.getToken()}}).then(function(t){e.$message({message:"Your change ID is: "+t.data.result,type:"success",duration:0,showCloseButton:!0}),""!==t.data.error&&e.$notify({title:"Slack webhook",message:t.data.error,type:"warning"})}).catch(function(t){e.$onError(t)}),this.closeModalBasic()},closeModalBasic:function(){this.selectedIndex=-1,this.showModal=!1},openDeleteModal:function(t){this.selectedIndex=t,this.showDeleteModal=!0},closeDeleteModal:function(){this.selectedIndex=-1,this.showDeleteModal=!1},deleteItem:function(t){var e=this,s=(""+this.$store.state.app.repoState.url).substring((""+this.$store.state.app.repoState.url).lastIndexOf("/")+1),a=""+this.$store.state.app.repoState.ref;s=s.substring(0,s.lastIndexOf(".git"));var i=this.$github,n="repos/"+this.$store.state.github.logininfo.username+"/"+s+"/git/"+a;"BitBucket"===this.$store.state.github.logininfo.type?(i=this.$bitbucket,i.setUserPass(this.$store.state.github.logininfo.username,this.$store.state.github.logininfo.pass),n="1.0/repositories/"+this.$store.state.github.logininfo.username+"/"+s+"/_branch/"+e.tableData[t].branch):i.setUserPass(this.$store.state.github.logininfo.username,this.$store.state.github.logininfo.pass),i.delete(n,function(t){e.closeDeleteModal(),e.$notify({title:"Success",message:"Deletion successful",type:"success"}),e.switchTab(0)},function(t){e.$onError(t),e.closeDeleteModal(),e.switchTab(0)})},loadPage:function(t){t<1||t>this.lastPage||this.search.searched||(this.currentPage=t,this.loading=!0)},itemContainsSearchString:function(t){if(t)for(var e=0;e<this.tableColumns.length;e++)if(t[this.tableColumns[e]].toString().includes(this.search.str))return!0;return!1},itemContainsRegexExpr:function(t){if(t)for(var e=0;e<this.tableColumns.length;e++)if(this.search.regexp.test(t[this.tableColumns[e].toString()]))return!0;return!1},searchByString:function(){var t=this;if(""!==this.search.str){this.tableData=[],this.search.found=0,this.search.searched=0,this.loading=this.lastPage,this.search.regexp=new RegExp(this.search.str);for(var e=0;e<this.lastPage;e++)this.$http.get("/api/users?type=token&offset="+(300*e).toString()).then(function(e){var s=!1;s=t.search.regex?e.data.result.filter(t.itemContainsRegexExpr):e.data.result.filter(t.itemContainsSearchString),t.search.found+=s.length,t.search.searched+=e.data.result.length,t.tableData=t.tableData.concat(s),t.loading=t.loading-1||!1}).catch(function(e){t.$onError(e),t.loading=t.loading-1||!1})}},resetSearch:function(){this.search.str="",this.search.found=0,this.search.searched=0,this.loadPage(this.currentPage)}}}},794:function(t,e,s){e=t.exports=s(676)(),e.push([t.i,".button[data-v-05d95b08]{margin:5px 0 0}.control .button[data-v-05d95b08]{margin:inherit}.fa-trash-o[data-v-05d95b08]{color:red}.fa-info[data-v-05d95b08]{color:#87cefa}","",{version:3,sources:["/data/serverless-cms-admin/client/views/versions/index.vue"],names:[],mappings:"AACA,yBACE,cAAgB,CACjB,AACD,kCACE,cAAgB,CACjB,AACD,6BACE,SAAW,CACZ,AACD,0BACE,aAAoB,CACrB",file:"index.vue",sourcesContent:["\n.button[data-v-05d95b08] {\n  margin: 5px 0 0;\n}\n.control .button[data-v-05d95b08] {\n  margin: inherit;\n}\n.fa-trash-o[data-v-05d95b08] {\n  color: red;\n}\n.fa-info[data-v-05d95b08] {\n  color: lightskyblue;\n}\n"],sourceRoot:""}])},819:function(t,e,s){var a=s(794);"string"==typeof a&&(a=[[t.i,a,""]]);s(677)(a,{});a.locals&&(t.exports=a.locals)},845:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"tile is-ancestor"},[s("div",{staticClass:"tile is-parent is-vertical"},[s("article",{staticClass:"tile is-child box"},[t.invalidRepo?s("div",[t.websiteIsGit?t._e():s("div",[t._v("\n          You are not using GIT.\n        ")]),t._v(" "),t.websiteIsGit?s("div",[t._v("\n            Error with repository. Contact us, and provide us with following error: "),s("br"),s("br"),t._v("Invalid Repository "+t._s(t.websiteId)),s("br"),t._v(" "),s("br"),t._v("\n            Apologize for the issue.\n            "),s("br")]):t._e()]):t._e(),t._v(" "),!t.invalidRepo&&t.notLoggedIn?s("div",[t._v("\n        You must be logged in with your Git account."),s("br"),t._v("\n        Please navigate to the Login screen using the left menu "),s("br")]):t._e(),t._v(" "),t.invalidRepo||t.notLoggedIn?t._e():s("div",[s("div",{staticClass:"tabs is-medium is-boxed is-fullwidth"},[s("ul",[s("li",{class:"token"===t.tabName?"is-active":"",on:{click:function(e){t.switchTab(0)}}},[s("a",[t._v("Versions")])]),t._v(" "),s("li",{class:"userpass"===t.tabName?"is-active":"",on:{click:function(e){t.switchTab(1)}}},[s("a",[t._v("Waiting on Reviews")])])])]),t._v(" "),"token"===t.tabName?s("div",{staticClass:"tile is-parent table-responsive is-vertical"},[s("nav",{staticClass:"pagination is-right"},[s("a",{staticClass:"pagination-previous",attrs:{disabled:t.loading},on:{click:function(e){t.search.show=!t.search.show}}},[t._v("Search")]),t._v(" "),s("a",{staticClass:"pagination-previous",attrs:{disabled:t.loading||t.currentPage<2||!!t.search.searched},on:{click:function(e){t.loadPage(t.currentPage-1)}}},[t._v("Previous")]),t._v(" "),s("a",{staticClass:"pagination-next",attrs:{disabled:t.loading||t.currentPage>t.lastPage-1||!!t.search.searched},on:{click:function(e){t.loadPage(t.currentPage+1)}}},[t._v("Next page")]),t._v(" "),s("ul",{staticClass:"pagination-list"},[s("li",[s("a",{staticClass:"pagination-link",class:1===t.currentPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(e){t.loadPage(1)}}},[t._v("1")])]),t._v(" "),t.currentPage>3&&t.lastPage>5?s("li",[s("span",{staticClass:"pagination-ellipsis"},[t._v("…")])]):t._e(),t._v(" "),t._l(t.nearbyPages,function(e){return s("li",[s("a",{staticClass:"pagination-link",class:e===t.currentPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(s){t.loadPage(e)}}},[t._v(t._s(e))])])}),t._v(" "),t.lastPage-t.currentPage>2&&t.lastPage>5&&1!==t.lastPage?s("li",[s("span",{staticClass:"pagination-ellipsis"},[t._v("…")])]):t._e(),t._v(" "),1!==t.lastPage?s("li",[s("a",{staticClass:"pagination-link",class:t.currentPage===t.lastPage?"is-current":"",attrs:{disabled:!!t.search.searched},on:{click:function(e){t.loadPage(t.lastPage)}}},[t._v(t._s(t.lastPage))])]):t._e()],2)]),t._v(" "),s("label",{staticClass:"label"}),t._v(" "),t.search.show?s("article",{staticClass:"tile is-child box"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger",class:t.loading?"is-loading":"",attrs:{disabled:0===t.search.searched},on:{click:function(e){t.resetSearch()}}},[t._v("\n                      Reset\n                    ")])])])]),t._v(" "),s("div",{staticClass:"level-item"},[0!==t.search.searched?s("p",{staticClass:"subtitle is-5"},[t._v("\n                  Found "),s("strong",[t._v(t._s(t.search.found))]),t._v(" matches out of "),s("strong",[t._v(t._s(t.search.searched))]),t._v(" tokens\n                ")]):s("p",{staticClass:"subtitle is-5"},[t._v("\n                  Displaying "),s("strong",[t._v(t._s(Math.min(t.tokenCount,300)))]),t._v(" out of "),s("strong",[t._v(t._s(t.tokenCount))]),t._v(" tokens\n                ")])]),t._v(" "),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[s("div",{staticClass:"field has-addons"},[s("p",{staticClass:"control has-icons-right"},[s("span",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.search.regex,expression:"search.regex"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.search.regex=e.target.multiple?s:s[0]}}},[s("option",{domProps:{value:!1}},[t._v("Substring")]),t._v(" "),s("option",{domProps:{value:!0}},[t._v("Regex")])])])]),t._v(" "),s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search.str,expression:"search.str"}],staticClass:"input",attrs:{type:"text",placeholder:"Search all tokens"},domProps:{value:t.search.str},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.searchByString()},input:function(e){e.target.composing||(t.search.str=e.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-info",class:t.loading?"is-loading":"",attrs:{disabled:""===t.search.str},on:{click:function(e){t.searchByString()}}},[t._v("\n                        Search\n                      ")])])])])])])]):t._e(),t._v(" "),s("label",{staticClass:"label"}),t._v(" "),s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(t._f("capitalize")(e))+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return e?s("td",["desc"==a?s("span",["master"==e.branch?s("span",[t._v("\n                      Production website\n                    ")]):t._e()]):t._e(),t._v("\n\n                    "+t._s(e[a])+"\n                ")]):s("td",[t._v("\n                  ERROR: An invalid token-accessor has been found\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},["master"!==e.branch?s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})]):t._e(),t._v(" "),"master"==e.branch?s("a",[s("i",{staticClass:"fa fa-trash-o",staticStyle:{color:"black",cursor:"default"}})]):t._e()])])],2)}))])]):t._e(),t._v(" "),"userpass"===t.tabName?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(e)+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return s("td",[t._v("\n                  "+t._s(e[a])+"\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})])])])],2)}))])]):t._e(),t._v(" "),"approle"===t.tabName?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table is-striped is-narrow"},[s("thead",[s("tr",[s("th"),t._v(" "),t._l(t.tableColumns,function(e){return s("th",[t._v("\n                  "+t._s(e)+"\n                ")])}),t._v(" "),s("th")],2)]),t._v(" "),s("tbody",t._l(t.tableData,function(e,a){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openModalBasic(a)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),t._l(t.tableColumns,function(a){return s("td",[t._v("\n                  "+t._s(e[a])+"\n                ")])}),t._v(" "),s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(e){t.openDeleteModal(a)}}},[s("i",{staticClass:"fa fa-trash-o"})])])])],2)}))])]):t._e()])])])]),t._v(" "),s("modal",{attrs:{visible:t.showModal,title:t.selectedItemTitle,desc:t.selectedItemDesc,updated_on:t.selectedItemUpdatedOn,commit:t.selectedItemCommit,branch:t.selectedItemBranch},on:{select:function(e){t.switchTo(e)},close:t.closeModalBasic}}),t._v(" "),s("confirmModal",{attrs:{visible:t.showDeleteModal,title:t.confirmDeletionTitle,info:t.selectedItemInfo},on:{close:t.closeDeleteModal,confirmed:function(e){t.deleteItem(t.selectedIndex)}}})],1)},staticRenderFns:[]}}});